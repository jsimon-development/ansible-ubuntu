---

- name: Check Composer version
  shell: composer --version
  register: composer_version
  ignore_errors: yes

- name: Install Composer
  shell: curl -sS https://getcomposer.org/installer | php && mv -f ./composer.phar /usr/local/bin/composer
  args:
    creates: /usr/local/bin/composer
    warn: false
  when: composer_version is failed

- name: Upgrade Composer
  shell: composer self-update
  ignore_errors: yes

- name: Make Composer executable
  file: path=/usr/local/bin/composer mode=0755